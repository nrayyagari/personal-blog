<style>
.highlight {
    position: relative;
}

.copy-button {
    position: absolute;
    left: 8px;
    top: 8px;
    padding: 0;
    background: transparent;
    border: none;
    color: #666;
    cursor: pointer;
    opacity: 0.6;
    transition: opacity 0.2s;
    width: 12px;
    height: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0;
}

.copy-button::before {
    content: "";
    width: 12px;
    height: 12px;
    background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="12" height="12" stroke="currentColor" stroke-width="2" fill="none"><rect x="9" y="9" width="10" height="10" rx="1"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>');
    background-size: contain;
    background-repeat: no-repeat;
    opacity: 0.6;
}

.copy-button:hover {
    opacity: 1;
}

.copy-button.success {
    color: #28a745;
}

[data-theme="dark"] .copy-button {
    color: rgba(255, 255, 255, 0.6);
}

[data-theme="dark"] .copy-button:hover {
    color: rgba(255, 255, 255, 0.9);
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('pre').forEach(function(pre) {
        if (pre.querySelector('.copy-button')) return;
        
        var button = document.createElement('button');
        button.className = 'copy-button';
        button.setAttribute('aria-label', 'Copy code');
        
        button.addEventListener('click', function() {
            var code = pre.querySelector('code') || pre;
            var text = code.innerText;
            
            navigator.clipboard.writeText(text).then(function() {
                button.classList.add('success');
                
                setTimeout(function() {
                    button.classList.remove('success');
                }, 2000);
            });
        });
        
        pre.appendChild(button);
    });
});
</script>
