<style>
.highlight {
    position: relative;
}

.copy-button {
    position: absolute;
    right: 8px;
    top: 8px;
    padding: 4px;
    background: rgba(255, 255, 255, 0.1);
    border: none;
    color: #666;
    cursor: pointer;
    opacity: 1;
    transition: opacity 0.2s;
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0;
    border-radius: 3px;
}

.copy-button::before {
    content: "";
    width: 12px;
    height: 12px;
    background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="12" height="12" stroke="currentColor" stroke-width="2.5" fill="none"><rect x="9" y="9" width="10" height="10"></rect><rect x="5" y="5" width="10" height="10"></rect></svg>');
    background-size: contain;
    background-repeat: no-repeat;
    opacity: 0.8;
}

.copy-button:hover {
    background: rgba(255, 255, 255, 0.2);
}

.copy-button.success {
    color: #28a745;
}

[data-theme="dark"] .copy-button {
    background: rgba(0, 0, 0, 0.2);
    color: rgba(255, 255, 255, 0.8);
}

[data-theme="dark"] .copy-button:hover {
    background: rgba(0, 0, 0, 0.3);
    color: rgba(255, 255, 255, 1);
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('pre').forEach(function(pre) {
        if (pre.querySelector('.copy-button')) return;
        
        var button = document.createElement('button');
        button.className = 'copy-button';
        button.setAttribute('aria-label', 'Copy code');
        
        button.addEventListener('click', function() {
            var code = pre.querySelector('code') || pre;
            var text = code.innerText;
            
            navigator.clipboard.writeText(text).then(function() {
                button.classList.add('success');
                
                setTimeout(function() {
                    button.classList.remove('success');
                }, 2000);
            });
        });
        
        pre.appendChild(button);
    });
});
</script>
